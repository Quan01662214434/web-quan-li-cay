<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Quáº£n lÃ½ vÆ°á»n â€“ Enterprise</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="app-layout">

  <!-- SIDEBAR -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-brand">
      <img src="images/logo.jpg" class="sidebar-logo" />
      <span>Farm Manager</span>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-item active" onclick="showSection('trees')">ğŸŒ³ CÃ¢y & QR</div>
      <div class="nav-item" onclick="showSection('staff')">ğŸ‘¨â€ğŸŒ¾ NhÃ¢n viÃªn</div>
      <div class="nav-item" onclick="showSection('activity')">ğŸ“œ Lá»‹ch sá»­</div>
    </nav>
  </aside>

  <!-- MAIN -->
  <main class="main-area">

    <!-- TREES -->
    <section class="section" id="section-trees">
      <div class="page-head">
        <h1>ğŸŒ³ Quáº£n lÃ½ cÃ¢y trá»“ng</h1>
        <p>Danh sÃ¡ch cÃ¢y vÃ  mÃ£ QR â€“ tá»‘i Æ°u cho nhiá»u vÆ°á»n</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">ğŸŒ³</div>
          <div class="stat-info">
            <div class="stat-label">Tá»•ng sá»‘ cÃ¢y</div>
            <div class="stat-value" id="stat-total">0</div>
          </div>
        </div>

        <div class="stat-card warning">
          <div class="stat-icon">âš ï¸</div>
          <div class="stat-info">
            <div class="stat-label">Cáº§n chÄƒm sÃ³c</div>
            <div class="stat-value" id="stat-warning">0</div>
          </div>
        </div>

        <div class="stat-card danger">
          <div class="stat-icon">ğŸ©º</div>
          <div class="stat-info">
            <div class="stat-label">CÃ¢y bá»‡nh</div>
            <div class="stat-value" id="stat-danger">0</div>
          </div>
        </div>
      </div>

      <div class="card">
        <input
          type="text"
          placeholder="ğŸ” TÃ¬m cÃ¢y theo tÃªn, khu, vá»‹ trÃ­..."
          style="width:100%;padding:10px;border-radius:10px;border:1px solid #e2efe4"
          oninput="onSearch(this.value)"
        />
      </div>

      <div class="tree-list" id="tree-list"></div>
    </section>

    <!-- STAFF -->
    <section class="section hidden" id="section-staff">
      <div class="page-head">
        <h1>ğŸ‘¨â€ğŸŒ¾ NhÃ¢n viÃªn</h1>
        <p>Quáº£n lÃ½ ngÆ°á»i tham gia chÄƒm sÃ³c vÆ°á»n</p>
      </div>

      <div class="empty-state">
        <h3>ChÆ°a cÃ³ dá»¯ liá»‡u nhÃ¢n viÃªn</h3>
        <p>TÃ­nh nÄƒng sáº½ Ä‘Æ°á»£c má»Ÿ khi má»Ÿ rá»™ng cho nhiá»u vÆ°á»n.</p>
      </div>
    </section>

    <!-- ACTIVITY -->
    <section class="section hidden" id="section-activity">
      <div class="page-head">
        <h1>ğŸ“œ Lá»‹ch sá»­ hoáº¡t Ä‘á»™ng</h1>
        <p>Theo dÃµi cÃ¡c thao tÃ¡c trong há»‡ thá»‘ng</p>
      </div>

      <div class="activity-timeline" id="activity-list">
        <div class="activity-item">
          <b>Há»‡ thá»‘ng</b> Ä‘Ã£ khá»Ÿi táº¡o thÃ nh cÃ´ng
        </div>
      </div>
    </section>

  </main>
</div>

<script>
/* ===============================
   DATA MOCK â€“ KHÃ”NG Äá»¤NG DB
   =============================== */
let lastTrees = [];
let treeSearchTerm = "";

/* ===============================
   NAV
   =============================== */
function showSection(name) {
  document.querySelectorAll(".section").forEach(s => s.classList.add("hidden"));
  document.getElementById("section-" + name).classList.remove("hidden");

  document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));
  event.target.classList.add("active");
}

/* ===============================
   SEARCH
   =============================== */
function onSearch(val) {
  treeSearchTerm = val;
  renderTreeList();
}

/* ===============================
   TREE RENDER (SAFE â€“ KHÃ”NG Máº¤T DATA)
   =============================== */
function renderTreeList() {
  const container = document.getElementById("tree-list");
  container.innerHTML = "";

  const term = treeSearchTerm.toLowerCase();
  const filtered = lastTrees.filter(t =>
    !term || `${t.name} ${t.area} ${t.location}`.toLowerCase().includes(term)
  );

  const MAX = 120;
  filtered.slice(0, MAX).forEach(t => {
    const health =
      t.currentHealth?.includes("Bá»‡nh") ? "health-bad" :
      t.currentHealth?.includes("Cáº§n") ? "health-warn" :
      "health-good";

    const el = document.createElement("div");
    el.className = "tree-card";
    el.innerHTML = `
      <div class="tree-card-header">
        <div class="tree-title">ğŸŒ³ ${t.name || "ChÆ°a Ä‘áº·t tÃªn"}</div>
        <span class="tree-health-badge ${health}">
          ${t.currentHealth || "ChÆ°a cáº­p nháº­t"}
        </span>
      </div>
      <div class="tree-sub">
        ğŸ“ ${t.area || "-"} ${t.location || ""}
      </div>
      <div class="tree-actions">
        <button class="btn-qr">QR</button>
        <button>Sá»­a</button>
      </div>
    `;
    container.appendChild(el);
  });

  updateStats(filtered);
}

/* ===============================
   KPI
   =============================== */
function updateStats(list) {
  document.getElementById("stat-total").textContent = list.length;
  document.getElementById("stat-warning").textContent =
    list.filter(t => t.currentHealth?.includes("Cáº§n")).length;
  document.getElementById("stat-danger").textContent =
    list.filter(t => t.currentHealth?.includes("Bá»‡nh")).length;
}

/* ===============================
   INIT (KHÃ”NG Äá»˜NG DB)
   =============================== */
document.addEventListener("DOMContentLoaded", () => {
  // MOCK: sau nÃ y thay báº±ng fetch API cÅ© cá»§a báº¡n
  lastTrees = []; // dá»¯ liá»‡u tháº­t cá»§a báº¡n váº«n giá»¯ nguyÃªn á»Ÿ backend
  renderTreeList();
});
</script>

</body>
</html>
