<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Th√¥ng tin c√¢y - Thanh Huy·ªÅn Farm</title>
    <link rel="stylesheet" href="public.css" />
  </head>
  <body>
    <div class="public-container fade-in">
      <div class="public-header">
        <!-- Anh ch·ªâ c·∫ßn thay logo.svg b·∫±ng logo th·∫≠t c·ªßa v∆∞·ªùn -->
        <img src="logo.svg" alt="Thanh Huy·ªÅn Farm" class="logo-spin" />
        <h2>Thanh Huy·ªÅn Farm</h2>
        <p>V∆∞·ªùn s·∫ßu ri√™ng ƒë·∫°t chu·∫©n VietGAP</p>
      </div>

      <div class="tree-info" id="treeInfo">
        <p>ƒêang t·∫£i th√¥ng tin c√¢y...</p>
      </div>

      <div class="footer">
        <p>
          üåø <b>Thanh Huy·ªÅn Farm</b><br />
          Hotline: 0912 345 678<br />
          ƒê·ªãa ch·ªâ: ·∫§p 3, x√£ H√≤a Kh√°nh, C√°i B√®, Ti·ªÅn Giang
        </p>
        <p class="note">
          Th√¥ng tin ƒë∆∞·ª£c c·∫≠p nh·∫≠t b·ªüi ch·ªß v∆∞·ªùn & nh√¢n vi√™n Thanh Huy·ªÅn.
        </p>
      </div>
    </div>

    <!-- N√∫t li√™n h·ªá n·ªïi -->
    <div class="floating-contact">
      <a
        href="https://zalo.me/0912345678"
        class="contact-btn zalo-btn"
        target="_blank"
      >
        Zalo
      </a>
      <a
        href="https://facebook.com/ThanhHuyenFarm"
        class="contact-btn fb-btn"
        target="_blank"
      >
        Facebook
      </a>
    </div>

    <script>
      // L·∫•y treeId t·ª´ URL
      const params = new URLSearchParams(window.location.search);
      const id = params.get("treeId");
      const API_BASE = "http://localhost:4000"; // N·∫øu deploy, ƒë·ªïi th√†nh https://api.thefram.site ho·∫∑c domain c·ªßa anh

      async function loadTree() {
        const info = document.getElementById("treeInfo");
        if (!id) {
          info.innerHTML = "‚ùå Kh√¥ng c√≥ m√£ c√¢y h·ª£p l·ªá trong QR!";
          return;
        }

        try {
          const res = await fetch(`${API_BASE}/public/tree/${id}`);
          const data = await res.json();

          if (!res.ok || !data.tree) {
            info.innerHTML = "‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y th√¥ng tin c√¢y n√†y!";
            return;
          }

          const t = data.tree;
          info.innerHTML = `
            <div><b>T√™n c√¢y:</b> ${t.name}</div>
            <div><b>Gi·ªëng c√¢y:</b> ${t.species || "-"}</div>
            <div><b>V·ªã tr√≠:</b> ${t.location || "-"}</div>
            <div><b>Khu v·ª±c:</b> ${t.area || "-"}</div>
            <div><b>Ng√†y tr·ªìng:</b> ${
              t.plantDate
                ? new Date(t.plantDate).toLocaleDateString("vi-VN")
                : "-"
            }</div>
            <div><b>M√£ s·ªë VietGAP:</b> ${t.vietGapCode || "-"}</div>
            <div><b>T√¨nh tr·∫°ng hi·ªán t·∫°i:</b> ${
              t.currentHealth || "B√¨nh th∆∞·ªùng"
            }</div>
            <div><b>Ghi ch√∫ chƒÉm s√≥c:</b> ${t.notes || "-"}</div>
          `;
        } catch (e) {
          info.innerHTML = "‚ö†Ô∏è L·ªói k·∫øt n·ªëi, vui l√≤ng th·ª≠ l·∫°i sau!";
        }
      }

      loadTree();
    </script>
  </body>
</html>
